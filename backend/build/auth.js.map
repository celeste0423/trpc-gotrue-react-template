{"version":3,"sources":["../src/auth.ts"],"sourcesContent":["import { GoTrueClient, SupportedStorage } from '@supabase/gotrue-js'\nimport fetch from 'cross-fetch'\nconst { GOTRUE_URL, GOTRUE_JWT_SECRET } = process.env\n\nconst inMemoryStorageFactory = (): SupportedStorage => {\n\tlet data: Record<string, string> = {}\n\treturn {\n\t\tgetItem: key => data[key] ?? null,\n\t\tremoveItem: key => {\n\t\t\tdata = Object.fromEntries(Object.entries(data).filter(([k]) => k !== key))\n\t\t},\n\t\tsetItem: (key, value) => {\n\t\t\tdata = {\n\t\t\t\t...data,\n\t\t\t\t[key]: value,\n\t\t\t}\n\t\t},\n\t}\n}\n\nexport const userAuthClient = new GoTrueClient({\n\turl: GOTRUE_URL,\n\tfetch,\n\tautoRefreshToken: true,\n\tpersistSession: true,\n\tstorage: inMemoryStorageFactory(),\n})\n\nexport const createUserAuthClient = (accessToken?: string) =>\n\tnew GoTrueClient({\n\t\turl: GOTRUE_URL,\n\t\tfetch,\n\t\tautoRefreshToken: true,\n\t\tpersistSession: true,\n\t\tstorage: inMemoryStorageFactory(),\n\t\theaders: {\n\t\t\tAuthorization: `Bearer ${accessToken}`,\n\t\t},\n\t})\n"],"names":["createUserAuthClient","userAuthClient","GOTRUE_URL","GOTRUE_JWT_SECRET","process","env","inMemoryStorageFactory","data","getItem","key","removeItem","Object","fromEntries","entries","filter","k","setItem","value","GoTrueClient","url","fetch","autoRefreshToken","persistSession","storage","accessToken","headers","Authorization"],"mappings":";;;;;;;;;;;IA4BaA,oBAAoB;eAApBA;;IARAC,cAAc;eAAdA;;;0BApBkC;mEAC7B;;;;;;AAClB,MAAM,EAAEC,UAAU,EAAEC,iBAAiB,EAAE,GAAGC,QAAQC,GAAG;AAErD,MAAMC,yBAAyB;IAC9B,IAAIC,OAA+B,CAAC;IACpC,OAAO;QACNC,SAASC,CAAAA,MAAOF,IAAI,CAACE,IAAI,IAAI;QAC7BC,YAAYD,CAAAA;YACXF,OAAOI,OAAOC,WAAW,CAACD,OAAOE,OAAO,CAACN,MAAMO,MAAM,CAAC,CAAC,CAACC,EAAE,GAAKA,MAAMN;QACtE;QACAO,SAAS,CAACP,KAAKQ;YACdV,OAAO;gBACN,GAAGA,IAAI;gBACP,CAACE,IAAI,EAAEQ;YACR;QACD;IACD;AACD;AAEO,MAAMhB,iBAAiB,IAAIiB,sBAAY,CAAC;IAC9CC,KAAKjB;IACLkB,OAAAA,mBAAK;IACLC,kBAAkB;IAClBC,gBAAgB;IAChBC,SAASjB;AACV;AAEO,MAAMN,uBAAuB,CAACwB,cACpC,IAAIN,sBAAY,CAAC;QAChBC,KAAKjB;QACLkB,OAAAA,mBAAK;QACLC,kBAAkB;QAClBC,gBAAgB;QAChBC,SAASjB;QACTmB,SAAS;YACRC,eAAe,CAAC,OAAO,EAAEF,YAAY,CAAC;QACvC;IACD"}